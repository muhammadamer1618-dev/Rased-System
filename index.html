<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>نظام راصد - MARS</title>

<link href="https://fonts.googleapis.com/css2?family=Calibri:wght@400;700&family=Cairo:wght@700&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>

<style>
body{
  font-family:Calibri;
  margin:0;
  background:#f0f4ff;
}

/* ===== Container ===== */
.container{
  max-width:900px;
  margin:40px auto;
  background:#fff;
  padding:25px;
  border-radius:20px;
  box-shadow:0 0 25px rgba(0,0,0,0.15);
}

/* ===== Title ===== */
h1{
  text-align:center;
  color:#0056b3;
  margin-bottom:0;
  font-family:Cairo;
  font-size:40px;
  font-weight:bold;
}

h2{
  text-align:center;
  color:#d32f2f;
  margin-top:5px;
  font-size:32px;
  font-family:"Brush Script MT", cursive;
  letter-spacing:3px;
}

/* ===== Roles Grid ===== */
.roles{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:20px;
  margin-top:30px
}

.role{
  background:#eef3ff;
  padding:15px;
  border-radius:15px;
  text-align:center;
  box-shadow:0 3px 8px rgba(0,0,0,0.1);
  cursor:pointer;
  font-weight:bold;
  transition:0.2s;
}
.role:hover{
  transform:scale(1.07);
  background:#dbe7ff;
}

.role input{
  margin-top:10px;
}

/* ===== Inputs ===== */
label{
  display:block;
  margin-top:15px;
  font-size:17px;
  font-weight:bold;
}

input{
  width:100%;
  padding:9px;
  border-radius:7px;
  border:1px solid #777;
  margin-top:5px;
  font-size:16px;
}

/* ===== Button ===== */
button{
  width:100%;
  margin-top:20px;
  padding:12px;
  border:none;
  border-radius:8px;
  background:#1976d2;
  color:#fff;
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
}
button:hover{
  opacity:0.9;
}

/* footer */
.footer{
  text-align:center;
  margin-top:20px;
  font-size:14px;
  color:#444;
}
.footer span{
  background:#e3f2fd;
  padding:3px 10px;
  border-radius:10px;
  color:#0d47a1;
}
.hidden{display:none}
</style>

</head>

<body>

<div class="container">

  <h1>نظام راصد</h1>
  <h2>M . A . R . S</h2>

  <!-- Roles -->
  <div class="roles">

    <div class="role">
      مدير النظام<br>
      <input type="radio" name="role" value="superadmin">
    </div>

    <div class="role">
      مدير الإشراف<br>
      <input type="radio" name="role" value="manager">
    </div>

    <div class="role">
      وكيل المدرسة<br>
      <input type="radio" name="role" value="principal">
    </div>

    <div class="role">
      مشرف<br>
      <input type="radio" name="role" value="supervisor">
    </div>

    <div class="role">
      موجه طلابي<br>
      <input type="radio" name="role" value="counselor">
    </div>

    <div class="role">
      معلم<br>
      <input type="radio" name="role" value="teacher">
    </div>

  </div>

  <!-- Username -->
  <label>اسم المستخدم</label>
  <input id="email_input" placeholder="User ID">

  <!-- Password -->
  <label>كلمة المرور</label>
  <input id="password_input" type="password" placeholder="••••••••">

  <button onclick="login()">دخول</button>

  <div class="footer">
    <span>تصميم محمد عامر أحمد</span> — الإصدار 2026
  </div>

</div>

<script>
var firebaseConfig={
  apiKey:"AIzaSyAfgSV-6_IMkXncgPWxY69omKfvFtGakgk",
  authDomain:"results2026-7c0dd.firebaseapp.com",
  projectId:"results2026-7c0dd",
  storageBucket:"results2026-7c0dd.firebasestorage.app",
  messagingSenderId:"241421115694",
  appId:"1:241421115694:web:96f55fd9fd1d5b18b31abf"
};
firebase.initializeApp(firebaseConfig);
var db=firebase.firestore();

async function login(){
  let role=document.querySelector('input[name="role"]:checked');
  if(!role){
    alert("اختر نوع المستخدم");
    return;
  }

  role=role.value;

  let email=document.getElementById("email_input").value.trim().toLowerCase();
  let pass=document.getElementById("password_input").value.trim();

  if(!email || !pass){
    alert("أدخل اسم المستخدم وكلمة المرور");
    return;
  }

  let doc=await db.collection("users").doc(email).get();
  if(!doc.exists){
    alert("المستخدم غير موجود");
    return;
  }

  let d=doc.data();
  if(d.password!==pass){
    alert("كلمة المرور غير صحيحة");
    return;
  }

  if(d.role!==role){
    alert("هذا المستخدم ليس لديه صلاحية الدخول كـ "+role);
    return;
  }

  localStorage.setItem("currentUserEmail",email);
  localStorage.setItem("currentUserName",d.name||"—");
  localStorage.setItem("currentUserRole",d.role);

  if(role==="superadmin") location="admin.html";
  if(role==="manager") location="manager.html";
  if(role==="principal") location="agent.html";
  if(role==="supervisor") location="supervisor.html";
  if(role==="counselor") location="counselor.html";
  if(role==="teacher") location="teacher.html";
}
</script>

</body>
</html>
